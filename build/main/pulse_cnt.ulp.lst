ESP32ULP GAS  pulse_cnt.ulp.pS 			page 1


   1              	       
   2              	 .bss
   3              	 .global wake_time
   4              	wake_time:
   5 0000 00000000 	 .long 0
   6              	 .global test
   7              	test:
   8 0004 00000000 	 .long 0
   9              	 .global wake_set
  10              	wake_set:
  11 0008 00000000 	 .long 0
  12              	 .global wake_period
  13              	wake_period:
  14 000c 00000000 	 .long 0
  15              	 .global next_edge
  16              	next_edge:
  17 0010 00000000 	 .long 0
  18              	 .global debounce_counter
  19              	debounce_counter:
  20 0014 00000000 	 .long 0
  21              	 .global debounce_max_count
  22              	debounce_max_count:
  23 0018 00000000 	 .long 0
  24              	 .global edge_count
  25              	edge_count:
  26 001c 00000000 	 .long 0
  27              	 .global edge_count_to_wake_up
  28              	edge_count_to_wake_up:
  29 0020 00000000 	 .long 0
  30              	 .global io_number
  31              	io_number:
  32 0024 00000000 	 .long 0
  33              	 .text
  34              	 .global entry
  35              	entry:
  36              	 .global start
  37              	start:
  38 0000 0901B82E 	 REG_RD ((((0x3ff48400 + 0x24)) - 0x3ff48000) / 4), ((14) + ((((((((0x3FFFF) >> (0)) & 1) + (((0x3F
  39 0004 03008072 	 move r3, io_number
  40 0008 0F0000D0 	 ld r3, r3, 0
  41 000c 3000C070 	 rsh r0, r0, r3
  42 0010 10004072 	 and r0, r0, 1
  43 0014 03008072 	 move r3, next_edge
  44 0018 0F0000D0 	 ld r3, r3, 0
  45 001c 33000070 	 add r3, r0, r3
  46 0020 1F004072 	 and r3, r3, 1
  47 0024 00004080 	 jump changed, eq
  48 0028 03008072 	 move r3, debounce_max_count
  49 002c 02008072 	 move r2, debounce_counter
  50 0030 0F0000D0 	 ld r3, r3, 0
  51 0034 0B000068 	 st r3, r2, 0
  52 0038 000000B0 	 halt
  53              	 .global wake_up
  54              	wake_up:
  55 003c 3000CC29 	 REG_RD ((((0x3ff48000 + 0xc0)) - 0x3ff48000) / 4), ((19) + ((((((((0x1) >> (0)) & 1) + (((0x1) >> 
  56 0040 10004072 	 and r0, r0, 1
  57 0044 00004080 	 jump wake_up, eq
ESP32ULP GAS  pulse_cnt.ulp.pS 			page 2


  58 0048 02008072 	 move r2, wake_set
  59 004c 03008072 	 move r3, 0
  60 0050 0B000068 	 st r3, r2, 0
  61 0054 01000090 	 wake
  62 0058 000000B0 	 halt
  63              	 .global changed
  64              	changed:
  65 005c 03008072 	 move r3, debounce_counter
  66 0060 0E0000D0 	 ld r2, r3, 0
  67 0064 0A000072 	 add r2, r2, 0
  68 0068 00004080 	 jump edge_detected, eq
  69 006c 1A002072 	 sub r2, r2, 1
  70 0070 0E000068 	 st r2, r3, 0
  71 0074 000000B0 	 halt
  72              	 .global edge_detected
  73              	edge_detected:
  74 0078 03008072 	 move r3, debounce_max_count
  75 007c 02008072 	 move r2, debounce_counter
  76 0080 0F0000D0 	 ld r3, r3, 0
  77 0084 0B000068 	 st r3, r2, 0
  78 0088 03008072 	 move r3, next_edge
  79 008c 0E0000D0 	 ld r2, r3, 0
  80 0090 1A000072 	 add r2, r2, 1
  81 0094 1A004072 	 and r2, r2, 1
  82 0098 0E000068 	 st r2, r3, 0
  83 009c 03008072 	 move r3, edge_count
  84 00a0 0E0000D0 	 ld r2, r3, 0
  85 00a4 1A000072 	 add r2, r2, 1
  86 00a8 0E000068 	 st r2, r3, 0
  87 00ac 000000B0 	 halt
